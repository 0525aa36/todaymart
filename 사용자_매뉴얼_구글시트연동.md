# 📊 구글 스프레드시트 주문 내역 연동 사용 매뉴얼

## 1. 기능 소개

판매자별 주문 내역을 구글 스프레드시트에 **자동으로 동기화**하는 기능입니다.
- 관리자 페이지에서 버튼 클릭 한 번으로 주문 내역을 구글 시트에 업데이트
- 판매자별로 별도의 스프레드시트 관리 가능
- 실시간 주문 현황을 엑셀처럼 확인하고 관리

---

## 2. 사용 방법

### 📌 방법 1: 관리자 페이지에서 동기화 (추천)

1. **관리자 로그인**
   - 웹사이트 접속: http://localhost:3000 (또는 실제 도메인)
   - 관리자 계정으로 로그인

2. **주문 관리 페이지 이동**
   - 상단 메뉴에서 **"관리자"** 클릭
   - 좌측 메뉴에서 **"주문 관리"** 클릭

3. **구글 시트 동기화 실행**
   - 페이지 상단에 있는 **"구글 시트 동기화"** 버튼 클릭
   - 몇 초 후 "동기화가 완료되었습니다" 메시지 확인

4. **구글 스프레드시트 확인**
   - 구글 시트 링크로 이동
   - 최신 주문 내역이 자동으로 업데이트되어 있음

### 📌 방법 2: 판매자별 필터링 후 동기화

1. 주문 관리 페이지에서 **"판매자 선택"** 드롭다운 클릭
2. 원하는 판매자 선택 (예: "석재민")
3. 해당 판매자의 주문만 필터링되어 표시됨
4. **"구글 시트 동기화"** 버튼 클릭
5. 해당 판매자의 구글 시트만 업데이트됨

---

## 3. 구글 스프레드시트 내용

동기화된 스프레드시트에는 다음 정보가 포함됩니다:

| 항목 | 설명 |
|------|------|
| **주문번호** | 시스템 자동 생성 주문 ID |
| **주문일시** | 주문이 접수된 날짜와 시간 |
| **고객명** | 주문한 고객 이름 |
| **고객이메일** | 고객 이메일 주소 |
| **상품명** | 주문한 상품 이름 |
| **수량** | 주문 수량 |
| **단가** | 상품 개당 가격 |
| **금액** | 총 금액 (단가 × 수량) |
| **주문상태** | 결제 완료, 배송중, 배송 완료 등 |
| **배송지** | 배송 주소 |
| **수령인** | 수령인 이름 |
| **연락처** | 수령인 전화번호 |
| **송장번호** | 택배 송장 번호 (있는 경우) |

### 스프레드시트 특징
- ✅ **헤더 행 고정**: 스크롤해도 컬럼명이 항상 보임
- ✅ **회색 배경 헤더**: 구분이 쉬움
- ✅ **자동 업데이트**: 기존 데이터를 지우고 최신 데이터로 덮어씀
- ✅ **판매자별 필터링**: 각 판매자는 자신의 상품이 포함된 주문만 확인

---

## 4. 주의사항 ⚠️

### ✔️ 해야 할 것
- 주문이 추가되거나 변경될 때마다 **동기화 버튼 클릭** (자동 동기화는 현재 비활성화)
- 구글 스프레드시트는 **읽기 전용으로만 사용** (직접 수정 가능하지만 다음 동기화 시 덮어씌워짐)
- 필요한 경우 스프레드시트를 **다운로드해서 백업** (파일 > 다운로드 > Excel)

### ❌ 하지 말아야 할 것
- 구글 시트에서 데이터를 직접 수정하지 말 것 (다음 동기화 시 사라짐)
- 헤더 행을 삭제하거나 수정하지 말 것
- 시트 이름 "주문내역"을 변경하지 말 것 (동기화 실패)

---

## 5. 문제 해결 (Troubleshooting)

### 문제 1: "동기화 실패" 메시지가 나올 때
**원인**: 구글 시트 권한 문제
**해결**:
1. 구글 스프레드시트 열기
2. 오른쪽 상단 "공유" 클릭
3. `sheets-sync-service@todaymart.iam.gserviceaccount.com` 이메일이 **편집자** 권한으로 있는지 확인
4. 없다면 추가 후 다시 동기화

### 문제 2: 스프레드시트가 비어있을 때
**원인**: 해당 판매자의 주문이 없거나, 시트 이름이 다름
**해결**:
1. 시스템에 주문 데이터가 있는지 확인
2. 스프레드시트 하단 탭 이름이 정확히 **"주문내역"**인지 확인
3. 오타나 공백이 있으면 수정 후 다시 동기화

### 문제 3: "구글 시트 동기화" 버튼이 보이지 않을 때
**원인**: 관리자 권한이 없거나 기능이 비활성화됨
**해결**:
1. 관리자 계정으로 로그인했는지 확인
2. 백엔드 서버 재시작 필요 시 개발자에게 문의

---

## 6. 구글 스프레드시트 링크

### 판매자: 석재민
📊 **스프레드시트 주소**:
https://docs.google.com/spreadsheets/d/1c4gbxZcybjXaEOgP9hte8vaIDN4c-f02Uv6mSvvUllA/edit

> **팁**: 이 링크를 즐겨찾기에 추가하면 빠르게 접근할 수 있습니다!

---

## 7. 자주 묻는 질문 (FAQ)

### Q1. 자동으로 동기화되나요?
**A**: 현재는 수동 동기화만 지원됩니다. 주문 관리 페이지에서 "구글 시트 동기화" 버튼을 클릭해야 합니다.
(향후 자동 동기화 기능 추가 예정: 매일 자정 자동 업데이트)

### Q2. 구글 시트에서 직접 수정해도 되나요?
**A**: 임시로 수정은 가능하지만, 다음 동기화 시 모두 덮어씌워집니다.
영구적으로 수정하려면 시스템(관리자 페이지)에서 주문 정보를 수정해야 합니다.

### Q3. 판매자별로 다른 스프레드시트를 사용할 수 있나요?
**A**: 네! 판매자마다 별도의 구글 스프레드시트를 설정할 수 있습니다.
데이터베이스에 판매자별 스프레드시트 ID를 등록하면 됩니다. (개발자에게 문의)

### Q4. 이전 주문 내역도 확인할 수 있나요?
**A**: 네! 동기화하면 시스템에 있는 **모든 주문 내역**이 스프레드시트에 표시됩니다.
과거 주문부터 최신 주문까지 모두 포함됩니다.

### Q5. 엑셀로 다운로드할 수 있나요?
**A**: 네! 구글 스프레드시트에서:
1. **파일 > 다운로드 > Microsoft Excel (.xlsx)** 선택
2. 컴퓨터에 저장되며, 엑셀에서 열기 가능

---

## 8. 연락처

기술 지원이 필요하시면 개발팀으로 연락주세요.

- **이메일**: support@todaymart.com
- **전화**: 010-XXXX-XXXX
- **문의 시간**: 평일 09:00 - 18:00

---

**📅 최종 업데이트**: 2025-11-09
**버전**: 1.0
